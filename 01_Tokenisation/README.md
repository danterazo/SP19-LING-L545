Dante's maxmatch implementation. Documentation coming soon...